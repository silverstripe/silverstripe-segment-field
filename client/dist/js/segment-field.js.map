{"version":3,"sources":["webpack:///webpack/bootstrap 4b128f468b440b25bc0d","webpack:///./client/src/bundles/segment-field.js"],"names":["window","jQuery","entwine","$","MaxPreviewLength","Ellipsis","onmatch","find","length","toggleEdit","redraw","_super","field","text","data","toggle","val","focus","update","current","updated","addClass","suggest","el","removeClass","suggestion","preview","cancel","callback","parts","closest","attr","split","url","encodeURIComponent","replace","ajax","dataType","success","error","xhr","statusText","responseText","complete","onclick","event","preventDefault","onkeydown","code","keyCode","which","stop"],"mappings":"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","file":"js/segment-field.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4b128f468b440b25bc0d","window.jQuery.entwine('ss', ($) => {\n  $('.field.segment:not(.readonly)').entwine({\n    MaxPreviewLength: 55,\n\n    Ellipsis: '...',\n\n    onmatch() {\n      if (this.find(':text').length) {\n        this.toggleEdit(false);\n      }\n\n      this.redraw();\n      this._super();\n    },\n\n    redraw() {\n      const field = this.find(':text');\n      // @todo these aren't used, should they be? Otherwise, remove\n      // const value = field.val();\n\n      // let preview = value;\n\n      // if (value.length > this.getMaxPreviewLength()) {\n      //   preview = this.getEllipsis()\n      //    + value.substr(value.length - this.getMaxPreviewLength(), value.length);\n      // }\n\n      this.find('.preview').text(field.data('preview'));\n    },\n\n    toggleEdit(toggle) {\n      const field = this.find(':text');\n\n      this.find('.preview-holder')[toggle ? 'hide' : 'show']();\n      this.find('.edit-holder')[toggle ? 'show' : 'hide']();\n\n      if (toggle) {\n        field.data('original', field.val());\n        field.focus();\n      }\n    },\n\n    update() {\n      const field = this.find(':text');\n      const current = field.data('original');\n      const updated = field.val();\n\n      if (current !== updated) {\n        this.addClass('loading');\n\n        this.suggest(updated, (data, el) => {\n          $(el).removeClass('loading');\n\n          field.val(data.suggestion);\n          field.data('preview', data.preview);\n\n          this.toggleEdit(false);\n          this.redraw();\n        });\n      } else {\n        this.toggleEdit(false);\n        this.redraw();\n      }\n    },\n\n    cancel() {\n      const field = this.find(':text');\n      field.val(field.data('original'));\n      this.toggleEdit(false);\n    },\n\n    suggest(val, callback) {\n      const field = this.find(':text');\n      const parts = this.closest('form').attr('action').split('?');\n\n      let url = `${parts[0]}/field/${field.attr('name')}/suggest/?value=${encodeURIComponent(val)}`;\n\n      if (parts[1]) {\n        url += `&${parts[1].replace(/^\\?/, '')}`;\n      }\n\n      $.ajax({\n        url,\n        dataType: 'json',\n        success(data) {\n          callback(data, this);\n        },\n        error(xhr) {\n          /* eslint no-param-reassign: [\"error\", { \"props\": false }]*/\n          xhr.statusText = xhr.responseText;\n        },\n        complete() {\n          field.removeClass('loading');\n        },\n      });\n    },\n  });\n\n  $('.field.segment .edit').entwine({\n    onclick(event) {\n      event.preventDefault();\n      this.closest('.field').toggleEdit(true);\n    },\n  });\n\n  $('.field.segment .update').entwine({\n    onclick(event) {\n      event.preventDefault();\n      this.closest('.field').update();\n    },\n  });\n\n  $('.field.segment .cancel').entwine({\n    onclick(event) {\n      event.preventDefault();\n      this.closest('.field').cancel();\n    },\n  });\n\n  $('.field.segment :text').entwine({\n    onkeydown(event) {\n      const code = event.keyCode || event.which;\n\n      if (code === 13) {\n        event.stop();\n        this.closest('.field').update();\n      }\n    },\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/bundles/segment-field.js"],"sourceRoot":""}